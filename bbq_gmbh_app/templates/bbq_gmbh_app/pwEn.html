<!DOCTYPE html>
<html lang="en">
    {% load static %}
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="This website is used by BBQ GmbH to record and determine the working hours of employees." />
        <meta name="author" content="H.Kniesick, P.Zurawel" />
        <meta name="Copyright" content="The source code is at all times the property of BBQ GmbH.">
        <title>BBQ GmbH - Employee time recording</title>
        <link rel="icon" type="image/x-icon" href="{% static 'bbq_gmbh_app/assets/favicon.ico'%}" />
        <!-- Font Awesome icons private kit pandora.temp -->
        <script src="https://kit.fontawesome.com/d670f74c3b.js" crossorigin="anonymous"></script>
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="{% static 'bbq_gmbh_app/css/styles.css'%}" rel="stylesheet" />
        <link href="{% static 'bbq_gmbh_app/css/signin.css'%}" rel="stylesheet" />
        <!-- online Bootstrap link for standard css-->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    </head>

    <body id="page-top" data-employee-management-url="{% url 'employeeManagement' %}">
        <!-- Navigation-->
        {% include 'bbq_gmbh_app/_navbar.html' %}

        <header class="masthead">
            <div class="container">
                <div class="form-signin" id="myElement">
                    <form id="passwordForm" method="post">
                        {% csrf_token %}
                        {% if request.user.is_authenticated %}
                            <div class="form-floating">
                                <input type="password" class="form-control rounded" id="old_password" name="old_password" placeholder="Current Password">
                                <label for="currentPassword">Old Password</label>
                            </div>
                            <div class="form-floating">
                                <input type="password" class="form-control rounded m-0" id="new_password1" name="new_password1" placeholder="New Password">
                                <label for="newPassword">New Password</label>
                            </div>
                            <div class="form-floating">
                                <input type="password" class="form-control rounded" id="new_password2" name="new_password2" placeholder="Confirm New Password">
                                <label for="confirmNewPassword">Confirm New Password</label>
                            </div>
                        
                            <button class="w-100 btn btn-lg btn-primary" type="submit" >Change Password</button>
                        {% endif %}
                          
                    </form>
                </div>
                <div class="alert_message"></div>
                {% if form.errors %}
                    <div class="card" style="display: block;">
                        <div class="card-body">
                            <div class="text-center" id="message">
                                {% for field, errors in form.errors.items %}
                                    {% for error in errors %}
                                        <p>{{ field }}: {{ error }}</p>
                                    {% endfor %}
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                {% endif %}
                </div>
            </div>
        </header>

        <!-- Contact-->
        {% include 'bbq_gmbh_app/_contact.html' %}

        <footer class="footer bg-black small text-center text-white-50"><div class="container px-4 px-lg-5">Copyright &copy; BBQ GmbH 2024</div></footer>
        

        <!-- Core theme JS-->
        <script src="{% static "bbq_gmbh_app/js/scripts.js" %}"></script>
        <script src="{% static "bbq_gmbh_app/js/navIcon.js" %}"></script>
        <!--Connecting std Bootstrap popper and js-->
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>

        <!-- error message-->
        <script>
            let errors = JSON.parse('{{ form.errors|escapejs|safe }}');
            document.querySelector('form').addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent the form from submitting
        
            if (Object.keys(errors).length > 0) {
                document.querySelector('.card').style.display = 'block';
                
                let message = '';
                for (let field in errors) {
                message += field + ': ' + errors[field].join(', ') + '<br>';
                }
                document.getElementById('message').innerHTML = message;
            } else {
                document.querySelector('form').submit();
            }
            });
        </script>
        
    </body>
</html>